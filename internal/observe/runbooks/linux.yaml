name: "Linux system investigation"
type: linux
aliases: [system, generic]
steps:
  - command: "uname -a"
    purpose: "identify kernel and system"
  - command: "whoami && id"
    purpose: "identify current user and groups"
  - command: "ps aux --sort=-%cpu | head -20"
    purpose: "list top processes by CPU usage"
  - command: "ss -tlnp 2>/dev/null || netstat -tlnp 2>/dev/null"
    purpose: "list listening ports and services"
  - command: "crontab -l 2>/dev/null; ls -la /etc/cron.d/ 2>/dev/null"
    purpose: "check cron jobs and scheduled tasks"
  - command: "awk -F: '$3==0 && $1!=\"root\" {print}' /etc/passwd"
    purpose: "check for rogue UID 0 users"
  - command: "find {{SCOPE}} -perm -o+w -type f 2>/dev/null | head -20"
    purpose: "find world-writable files in scope"
  - command: "find {{SCOPE}} -newer /etc/hostname -type f 2>/dev/null | head -20"
    purpose: "find recently modified files in scope"
  - command: "last -n 10 2>/dev/null || echo 'last command not available'"
    purpose: "check recent login history"
  - command: "df -h && free -m"
    purpose: "check disk and memory usage"
